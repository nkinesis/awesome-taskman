{"ast":null,"code":"import _classCallCheck from \"/home/gabriel/Documents/Projetos/React/atm-react/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/gabriel/Documents/Projetos/React/atm-react/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/gabriel/Documents/Projetos/React/atm-react/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/gabriel/Documents/Projetos/React/atm-react/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/gabriel/Documents/Projetos/React/atm-react/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/gabriel/Documents/Projetos/React/atm-react/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/gabriel/Documents/Projetos/React/atm-react/src/components/TaskSearch.js\";\nimport React from 'react';\nimport { Database } from '../model/database.js';\nimport { Select } from '../model/select.js';\nimport { TaskList } from './TaskList.js';\nimport { Task } from '../model/task.js';\nimport { Utils } from '../model/utils.js';\nimport '../index.css';\nexport var TaskSearch =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(TaskSearch, _React$Component);\n\n  function TaskSearch(props) {\n    var _this;\n\n    _classCallCheck(this, TaskSearch);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(TaskSearch).call(this, props));\n    var u = new Utils();\n    _this.state = {\n      compName: \"Search\",\n      objList: null,\n      sDate: u.getDate(),\n      sName: \"\",\n      sFinish: false\n    };\n    _this.getTasks = _this.getTasks.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.formChange = _this.formChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.formKeyPress = _this.formKeyPress.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(TaskSearch, [{\n    key: \"getTasks\",\n    value: function getTasks(where) {\n      var db = new Database();\n      var ctx = this;\n      var params = new Select(where, 10, \"dueDate desc\");\n      db.select(\"Task\", params).then(function (response) {\n        ctx.setState({\n          objList: [response]\n        });\n      });\n    }\n  }, {\n    key: \"buildWhere\",\n    value: function buildWhere() {\n      var where = \"dueDate = '\" + this.state.sDate + \"' \";\n\n      if (this.state.sFinish) {\n        where += \"and status >= 0 \";\n      } else {\n        console.log(\"pending only\");\n        where += \"and status = 0 \";\n      }\n\n      if (this.state.sName.trim().length > 0) {\n        where += \"and description like '%\" + this.state.sName + \"%'\";\n      }\n\n      return where;\n    }\n  }, {\n    key: \"completeTask\",\n    value: function completeTask(e) {\n      var selId = e.target.parentNode.getAttribute(\"idtask\");\n\n      if (selId) {\n        var db = new Database();\n        var ctx = this;\n        var updObj;\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = this.state.objList[0].data[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var task = _step.value;\n\n            if (task.id_task === Number.parseInt(selId)) {\n              updObj = task;\n              break;\n            }\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator.return != null) {\n              _iterator.return();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n\n        if (updObj && updObj.status === 0) {\n          updObj.status = \"1\";\n          db.update(\"Task\", updObj).then(function (response) {\n            console.log(response);\n            ctx.getTasks();\n          });\n        } else {\n          window.alert(\"This task has already been finished.\");\n        }\n      }\n    }\n  }, {\n    key: \"removeTask\",\n    value: function removeTask(e) {\n      if (window.confirm('Are you sure you want to delete this task?')) {\n        var selId = e.target.parentNode.getAttribute(\"idtask\");\n\n        if (selId) {\n          var db = new Database();\n          var delObj = new Task(\"\", 1, 1, \"\", selId);\n          var ctx = this;\n          db.delete(\"Task\", delObj).then(function (response) {\n            console.log(response);\n            ctx.getTasks();\n          });\n        }\n      }\n    }\n  }, {\n    key: \"setSelected\",\n    value: function setSelected() {//Nothing to do\n    }\n  }, {\n    key: \"formChange\",\n    value: function formChange(e) {\n      var ctx = this;\n\n      if (e.target.id === \"sDate\") {\n        this.setState({\n          sDate: e.target.value\n        });\n      } else if (e.target.id === \"sName\") {\n        this.setState({\n          sName: e.target.value\n        });\n      } else if (e.target.id === \"sFinish\") {\n        console.log(\"ch-ch-changes\");\n        this.setState({\n          sFinish: e.target.value\n        }, function () {\n          ctx.getTasks(ctx.buildWhere());\n        });\n      }\n    }\n  }, {\n    key: \"formKeyPress\",\n    value: function formKeyPress(e) {\n      if (e.key === \"Enter\") {\n        if (e.target.id === \"sDate\" && e.target.value.length === 10) {\n          document.querySelector(\"#sName\").focus();\n        } else if (e.target.id === \"sName\") {\n          document.querySelector(\"#sFinish\").focus();\n        } else if (e.target.id === \"sFinish\") {\n          document.querySelector(\"#sDate\").focus();\n        }\n\n        this.getTasks(this.buildWhere());\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var u = new Utils();\n      var status = \"and status = 0 \";\n\n      if (this.state.sFinish) {\n        status = \"and status >= 0 \";\n      }\n\n      this.getTasks(\"dueDate = '\" + u.getDate() + \"' \" + status);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (this.state.objList) {\n        return React.createElement(\"div\", {\n          className: \"mainWrapper\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"form-group\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        }, \"Search By Date\"), React.createElement(\"input\", {\n          autoFocus: true,\n          id: \"sDate\",\n          className: \"form-control\",\n          type: \"date\",\n          onChange: this.formChange,\n          onKeyPress: this.formKeyPress,\n          value: this.state.sDate,\n          max: \"2099-12-31\",\n          min: \"2001-01-01\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }), React.createElement(\"label\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }, \"Search By Description\"), React.createElement(\"input\", {\n          id: \"sName\",\n          className: \"form-control\",\n          type: \"text\",\n          onChange: this.formChange,\n          onKeyPress: this.formKeyPress,\n          value: this.state.sName,\n          maxLength: \"20\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          className: \"form-group form-check\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          id: \"sFinish\",\n          className: \"form-check-input\",\n          type: \"checkbox\",\n          onChange: this.formChange,\n          onKeyPress: this.formKeyPress,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }), React.createElement(\"label\", {\n          className: \"form-check-label\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, \"Show finished\"))), React.createElement(TaskList, {\n          objList: this.state.objList[0].data,\n          setSelected: function setSelected(fn) {\n            return _this2.setSelected(fn);\n          },\n          removeTask: function removeTask(fn) {\n            return _this2.removeTask(fn);\n          },\n          completeTask: function completeTask(fn) {\n            return _this2.completeTask(fn);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159\n          },\n          __self: this\n        }));\n      } else {\n        return React.createElement(\"div\", {\n          className: \"mainWrapper\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167\n          },\n          __self: this\n        }, \"Loading...\");\n      }\n    }\n  }]);\n\n  return TaskSearch;\n}(React.Component);\nexport default TaskSearch;","map":{"version":3,"sources":["/home/gabriel/Documents/Projetos/React/atm-react/src/components/TaskSearch.js"],"names":["React","Database","Select","TaskList","Task","Utils","TaskSearch","props","u","state","compName","objList","sDate","getDate","sName","sFinish","getTasks","bind","formChange","formKeyPress","where","db","ctx","params","select","then","response","setState","console","log","trim","length","e","selId","target","parentNode","getAttribute","updObj","data","task","id_task","Number","parseInt","status","update","window","alert","confirm","delObj","delete","id","value","buildWhere","key","document","querySelector","focus","fn","setSelected","removeTask","completeTask","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Database } from '../model/database.js';\nimport { Select } from '../model/select.js';\nimport { TaskList } from './TaskList.js';\nimport { Task } from '../model/task.js';\nimport { Utils } from '../model/utils.js';\nimport '../index.css';\n\nexport class TaskSearch extends React.Component {\n    constructor(props) {\n        super(props);\n        var u = new Utils();\n        this.state = {\n            compName: \"Search\",\n            objList: null,\n            sDate: u.getDate(),\n            sName: \"\",\n            sFinish: false\n\n        }\n        this.getTasks = this.getTasks.bind(this);\n        this.formChange = this.formChange.bind(this);\n        this.formKeyPress = this.formKeyPress.bind(this);\n    }\n\n    getTasks(where) {\n        var db = new Database();\n        var ctx = this;\n        var params = new Select(where, 10, \"dueDate desc\");\n        db.select(\"Task\", params).then(function (response) {\n            ctx.setState({\n                objList: [response]\n            });\n        });\n    }\n\n    buildWhere() {\n        var where = \"dueDate = '\" + this.state.sDate + \"' \";\n        if (this.state.sFinish) {\n            where += \"and status >= 0 \";\n        } else {\n            console.log(\"pending only\");\n            where += \"and status = 0 \";\n        }\n        if (this.state.sName.trim().length > 0) {\n            where += \"and description like '%\" + this.state.sName + \"%'\";\n        }\n        return where;\n    }\n\n    completeTask(e) {\n        var selId = e.target.parentNode.getAttribute(\"idtask\");\n        if (selId) {\n            var db = new Database();\n            var ctx = this;\n            var updObj;\n            for (var task of this.state.objList[0].data) {\n                if (task.id_task === Number.parseInt(selId)) {\n                    updObj = task;\n                    break;\n                }\n            }\n            if (updObj && updObj.status === 0) {\n                updObj.status = \"1\";\n                db.update(\"Task\", updObj).then(\n                    function (response) {\n                        console.log(response);\n                        ctx.getTasks();\n                    }\n                );\n            } else {\n                window.alert(\"This task has already been finished.\")\n            }\n        }\n    }\n\n    removeTask(e) {\n        if (window.confirm('Are you sure you want to delete this task?')) {\n            var selId = e.target.parentNode.getAttribute(\"idtask\");\n            if (selId) {\n                var db = new Database();\n                var delObj = new Task(\"\", 1, 1, \"\", selId);\n                var ctx = this;\n                db.delete(\"Task\", delObj).then(\n                    function (response) {\n                        console.log(response);\n                        ctx.getTasks();\n                    }\n                );\n            }\n        }\n    }\n\n    setSelected(){\n        //Nothing to do\n    }\n\n    formChange(e) {\n        var ctx = this;\n        if (e.target.id === \"sDate\") {\n            this.setState({ sDate: e.target.value });\n        } else if (e.target.id === \"sName\") {\n            this.setState({ sName: e.target.value });\n        } else if (e.target.id === \"sFinish\") {\n            console.log(\"ch-ch-changes\")\n            this.setState({ sFinish: e.target.value }, function(){\n                ctx.getTasks(ctx.buildWhere());\n            });\n        }\n    }\n\n    formKeyPress(e) {\n        if (e.key === \"Enter\") {\n            if (e.target.id === \"sDate\" && e.target.value.length === 10) {\n                document.querySelector(\"#sName\").focus();\n            } else if (e.target.id === \"sName\") {\n                document.querySelector(\"#sFinish\").focus();\n            } else if (e.target.id === \"sFinish\") {\n                document.querySelector(\"#sDate\").focus();\n            }\n            this.getTasks(this.buildWhere());\n        }\n    }\n\n    componentDidMount() {\n        var u = new Utils();\n        var status = \"and status = 0 \";\n        if (this.state.sFinish) {\n            status = \"and status >= 0 \";\n        }\n        this.getTasks(\"dueDate = '\" + u.getDate() + \"' \" + status);\n    }\n\n    render() {\n        if (this.state.objList) {\n            return <div className=\"mainWrapper\">\n                <div className=\"form-group\">\n                    <label>Search By Date</label>\n                    <input autoFocus id=\"sDate\" className=\"form-control\"\n                        type=\"date\" onChange={this.formChange}\n                        onKeyPress={this.formKeyPress}\n                        value={this.state.sDate}\n                        max=\"2099-12-31\" min=\"2001-01-01\"\n                    ></input>\n                    <label>Search By Description</label>\n                    <input id=\"sName\" className=\"form-control\"\n                        type=\"text\" onChange={this.formChange}\n                        onKeyPress={this.formKeyPress}\n                        value={this.state.sName}\n                        maxLength=\"20\"\n                    ></input>\n                    <div className=\"form-group form-check\">\n                        <input id=\"sFinish\" className=\"form-check-input\"\n                            type=\"checkbox\" onChange={this.formChange}\n                            onKeyPress={this.formKeyPress}></input>\n                        <label className=\"form-check-label\">Show finished</label>\n                    </div>\n                </div>\n                <TaskList\n                    objList={this.state.objList[0].data}\n                    setSelected={fn => this.setSelected(fn)}\n                    removeTask={fn => this.removeTask(fn)}\n                    completeTask={fn => this.completeTask(fn)}\n                ></TaskList>\n            </div>\n        } else {\n            return <div className=\"mainWrapper\">\n                Loading...\n        </div>\n        }\n\n    }\n}\n\nexport default TaskSearch;"]},"metadata":{},"sourceType":"module"}